# Smart Tourist Safety API Documentation

This document provides a comprehensive list of all API endpoints available in the Smart Tourist Safety & Incident Response System.

## Base URL
```
http://165.232.188.221:8000
```

## Authentication
Currently, the API does not require authentication. In a production environment, proper authentication should be implemented.

---

## üßë‚Äçüåæ Tourist Management

### Register a Tourist
```http
POST /registerTourist
```
Register a new tourist in the system.

**Request Body:**
```json
{
  "name": "John Doe",
  "contact": "+919876543210",
  "email": "john@example.com",
  "emergency_contact": "+911234567890",
  "trip_info": {
    "start_date": "2025-09-25",
    "end_date": "2025-10-05",
    "places": ["Delhi", "Agra", "Jaipur"],
    "purpose": "Tourism"
  },
  "age": 28,
  "nationality": "UK",
  "passport_number": "UK12345678"
}
```

**Response:**
```json
{
  "id": 1,
  "name": "John Doe",
  "contact": "+919876543210",
  "email": "john@example.com",
  "trip_info": {
    "start_date": "2025-09-25",
    "end_date": "2025-10-05",
    "places": ["Delhi", "Agra", "Jaipur"],
    "purpose": "Tourism"
  },
  "emergency_contact": "+911234567890",
  "safety_score": 100,
  "age": 28,
  "nationality": "UK",
  "passport_number": "UK12345678",
  "is_active": true,
  "created_at": "2025-09-28T10:15:30Z",
  "updated_at": "2025-09-28T10:15:30Z"
}
```

### Get Tourist Details
```http
GET /tourists/{tourist_id}
```
Get detailed information about a specific tourist.

**Response:**
```json
{
  "id": 1,
  "name": "John Doe",
  "contact": "+919876543210",
  "email": "john@example.com",
  "trip_info": {
    "start_date": "2025-09-25",
    "end_date": "2025-10-05",
    "places": ["Delhi", "Agra", "Jaipur"],
    "purpose": "Tourism"
  },
  "emergency_contact": "+911234567890",
  "safety_score": 100,
  "age": 28,
  "nationality": "UK",
  "passport_number": "UK12345678",
  "is_active": true,
  "last_location_update": "2025-09-28T12:15:30Z",
  "created_at": "2025-09-28T10:15:30Z",
  "updated_at": "2025-09-28T10:15:30Z"
}
```

### Update Tourist Profile
```http
PUT /tourists/{tourist_id}
```
Update tourist profile information.

**Request Body:**
```json
{
  "name": "John Doe Updated",
  "contact": "+919876543210",
  "emergency_contact": "+911234567890",
  "email": "john.updated@example.com"
}
```

**Response:** Full updated tourist object similar to GET response.

### List All Tourists
```http
GET /tourists/
```
Get list of all registered tourists (admin feature).

**Query Parameters:**
- `skip` (optional): Number of records to skip (default: 0)
- `limit` (optional): Maximum number of records to return (default: 100)
- `active_only` (optional): If true, returns only active tourists (default: true)

**Response:**
```json
[
  {
    "id": 1,
    "name": "John Doe",
    "contact": "+919876543210",
    "email": "john@example.com",
    "safety_score": 100,
    "is_active": true,
    "last_location_update": "2025-09-28T12:15:30Z"
  }
]
```

### Delete Tourist
```http
DELETE /tourists/{tourist_id}
```
Deactivate a tourist account (soft delete).

**Response:** No content (204)

---

## üìç Location Management

### Send Location Update
```http
POST /sendLocation
```
Send tourist location update.

**Request Body:**
```json
{
  "tourist_id": 1,
  "latitude": 28.6139,
  "longitude": 77.2090,
  "altitude": 220.5,
  "accuracy": 5.0,
  "speed": 2.5
}
```

**Response:**
```json
{
  "id": 1,
  "tourist_id": 1,
  "latitude": 28.6139,
  "longitude": 77.2090,
  "altitude": 220.5,
  "accuracy": 5.0,
  "speed": 2.5,
  "heading": null,
  "timestamp": "2025-09-28T12:15:30Z",
  "created_at": "2025-09-28T12:15:30Z"
}
```

### Get All Locations
```http
GET /locations/all
```
Get latest location of all active tourists.

**Query Parameters:**
- `skip` (optional): Number of records to skip (default: 0)
- `limit` (optional): Maximum number of records to return (default: 100)

**Response:**
```json
[
  {
    "tourist_id": 1,
    "tourist_name": "John Doe",
    "latitude": 28.6139,
    "longitude": 77.2090,
    "timestamp": "2025-09-28T12:15:30Z",
    "safety_score": 85
  }
]
```

### Get Tourist Location History
```http
GET /locations/tourist/{tourist_id}
```
Get location tracking history for a specific tourist.

**Query Parameters:**
- `limit` (optional): Maximum number of records to return (default: 50)

**Response:**
```json
[
  {
    "id": 15,
    "tourist_id": 1,
    "latitude": 28.6139,
    "longitude": 77.2090,
    "timestamp": "2025-09-28T12:15:30Z",
    "accuracy": 5.0,
    "speed": 2.5
  }
]
```

### Get Latest Location
```http
GET /locations/latest/{tourist_id}
```
Get the most recent location for a tourist.

**Response:**
```json
{
  "id": 23,
  "tourist_id": 1,
  "latitude": 28.6139,
  "longitude": 77.2090,
  "timestamp": "2025-09-28T12:15:30Z",
  "accuracy": 5.0,
  "speed": 2.5,
  "heading": null,
  "created_at": "2025-09-28T12:15:30Z"
}
```

### Search Locations
```http
GET /locations/search
```
Search for locations using local database.

**Query Parameters:**
- `query`: Search term (tourist name or partial coordinates)
- `limit` (optional): Maximum number of results to return (default: 50)

**Response:**
```json
[
  {
    "name": "India Gate, New Delhi",
    "latitude": 28.6129,
    "longitude": 77.2295,
    "type": "landmark"
  }
]
```

---

## ‚ö†Ô∏è Alert Management

### Create Panic Alert (SOS)
```http
POST /pressSOS
```
Create an emergency SOS alert for a tourist.

**Request Body:**
```json
{
  "tourist_id": 1,
  "latitude": 28.6139,
  "longitude": 77.2090,
  "message": "Emergency! Need immediate assistance!"
}
```

**Response:** Alert object with all details.

### Create Geofence Alert
```http
POST /alerts/geofence
```
Create a geofence alert when tourists enter restricted zones.

**Request Body:**
```json
{
  "tourist_id": 1,
  "latitude": 28.6139,
  "longitude": 77.2090,
  "zone_name": "High Risk Area - Downtown",
  "zone_id": "zone_001"
}
```

**Response:** Alert object with all details.

### Get All Alerts
```http
GET /getAlerts
```
Get alerts with optional filtering.

**Query Parameters:**
- `status` (optional): Filter by status (default: "active")
- `severity` (optional): Filter by severity
- `alert_type` (optional): Filter by type
- `skip` (optional): Number of records to skip (default: 0)
- `limit` (optional): Maximum number of records to return (default: 100)

**Response:**
```json
[
  {
    "id": 1,
    "tourist_id": 1,
    "tourist_name": "John Doe",
    "type": "panic",
    "severity": "critical",
    "message": "Emergency assistance needed",
    "latitude": 28.6139,
    "longitude": 77.2090,
    "timestamp": "2025-09-28T12:15:30Z",
    "status": "active"
  }
]
```

### Get Specific Alert
```http
GET /alerts/{alert_id}
```
Get detailed information about a specific alert.

**Response:**
```json
{
  "id": "alert_001",
  "type": "panic",
  "severity": "high",
  "message": "Emergency assistance needed",
  "tourist_id": 1,
  "latitude": 28.6139,
  "longitude": 77.2090,
  "timestamp": "2025-09-28T12:15:30Z",
  "status": "active"
}
```

### Acknowledge Alert
```http
PUT /alerts/{alert_id}/acknowledge
```
Mark alerts as read/acknowledged by the user.

**Request Body:**
```json
{
  "acknowledged_by": "tourist_123",
  "acknowledgment_time": "2025-09-28T12:15:30Z"
}
```

**Response:** Updated alert object.

### Resolve Alert
```http
PUT /alerts/{alert_id}/resolve
```
Mark an alert as resolved.

**Request Body:**
```json
{
  "resolved_by": "police_officer_123",
  "resolution_notes": "Assisted tourist and resolved the situation"
}
```

**Response:** Updated alert object.

### Forward Alert
```http
POST /alerts/forwardAlert/{alert_id}
```
Forward alerts to emergency contacts or authorities.

**Request Body:**
```json
{
  "recipient_contact": "+919876543210",
  "message": "Emergency alert forwarded from Smart Tourist Safety App"
}
```

**Response:**
```json
{
  "success": true,
  "message": "Alert forwarded to emergency response systems",
  "alert_id": 1
}
```

### Get Panic Alerts Count
```http
GET /alerts/panicAlertsCount
```
Get total count of panic alerts for dashboard statistics.

**Response:**
```json
{
  "total_panic_alerts": 15,
  "active_panic_alerts": 3,
  "resolved_panic_alerts": 12
}
```

---

## üó∫Ô∏è Zone Management

### Get Restricted Zones
```http
GET /getRestrictedZones
```
Get list of all restricted zones for geofencing.

**Query Parameters:**
- `is_active` (optional): Filter for active zones only (default: true)

**Response:**
```json
[
  {
    "id": "zone_001",
    "name": "High Risk Area - Downtown",
    "description": "Area with elevated security concerns",
    "type": "dangerous",
    "coordinates": {
      "type": "Polygon",
      "coordinates": [
        [
          [77.2090, 28.6139],
          [77.2095, 28.6145],
          [77.2100, 28.6140],
          [77.2090, 28.6139]
        ]
      ]
    },
    "city": "Delhi",
    "danger_level": 4,
    "is_active": true
  }
]
```

### Get Safe Zones
```http
GET /safe-zones
```
Get list of all safe zones for tourist guidance.

**Query Parameters:**
- `is_active` (optional): Filter for active zones only (default: true)

**Response:**
```json
[
  {
    "id": 1,
    "name": "Tourist Hub - Connaught Place",
    "description": "Safe tourist area with police presence",
    "zone_type": "tourist_area",
    "coordinates": {
      "type": "Polygon",
      "coordinates": [
        [
          [77.2090, 28.6139],
          [77.2095, 28.6145],
          [77.2100, 28.6140],
          [77.2090, 28.6139]
        ]
      ]
    },
    "city": "Delhi",
    "safety_rating": 5,
    "is_active": true
  }
]
```

---

## üö® E-FIR Management

### File E-FIR
```http
POST /fileEFIR
```
File electronic First Information Report for incidents.

**Request Body:**
```json
{
  "tourist_id": 1,
  "incident_type": "theft",
  "description": "Mobile phone stolen at market",
  "location": {
    "latitude": 28.6139,
    "longitude": 77.2090,
    "location_name": "Sadar Bazaar"
  },
  "incident_time": "2025-09-28T11:30:00Z",
  "items_lost": ["iPhone 15", "Wallet"],
  "approximate_value": 95000,
  "witnesses": [
    {
      "name": "Jane Doe",
      "contact": "+919876543211"
    }
  ]
}
```

**Response:**
```json
{
  "fir_number": "EFIR-2025-09-28-001",
  "status": "filed",
  "filing_time": "2025-09-28T12:15:30Z",
  "tourist_id": 1,
  "tourist_name": "John Doe",
  "incident_details": {
    "incident_type": "theft",
    "description": "Mobile phone stolen at market",
    "incident_time": "2025-09-28T11:30:00Z",
    "location": {
      "latitude": 28.6139,
      "longitude": 77.2090,
      "location_name": "Sadar Bazaar"
    }
  },
  "police_station": {
    "name": "Sadar Bazaar Police Station",
    "code": "SBPS",
    "contact": "100"
  },
  "next_steps": [
    "Visit the nearest police station for verification",
    "Carry your ID proof",
    "An officer will contact you within 24 hours"
  ]
}
```

---

## ü§ñ AI Assessment

### Get Tourist Safety Assessment
```http
GET /api/v1/ai-assessment/tourist/{tourist_id}
```
Get the latest AI safety assessment for a tourist.

**Response:**
```json
{
  "tourist_id": 1,
  "safety_score": 85,
  "severity": "WARNING",
  "assessment_factors": {
    "geofence_alert": false,
    "anomaly_score": 0.35,
    "temporal_risk_score": 0.25,
    "supervised_prediction": 0.2
  },
  "recommended_actions": [
    "Tourist should be careful in current area",
    "Avoid poorly lit streets after dark"
  ],
  "timestamp": "2025-09-28T12:15:30Z"
}
```

---

## üì± Real-time Communication

### Connect to Realtime Updates
```
WebSocket: ws://165.232.188.221:8000/api/v1/realtime/connect
```

Connect to receive real-time updates for alerts, location changes, and safety assessments.

**Connection Parameters:**
- `token`: Authentication token
- `client_id`: Unique client identifier
- `tourist_id` (optional): Specific tourist to monitor

**Message Types:**
- `alert`: New alert created
- `location_update`: Tourist location changed
- `safety_assessment`: New safety assessment available
- `system_notification`: System-wide notification

---

## üíª System Information

### Health Check
```http
GET /health
```
Check if the API is running and connected to the database.

**Response:**
```json
{
  "status": "healthy",
  "timestamp": 1726736130.456,
  "version": "1.0.0",
  "database": "connected"
}
```

### Root Information
```http
GET /
```
Get basic API information.

**Response:**
```json
{
  "message": "Smart Tourist Safety & Incident Response System API",
  "version": "1.0.0",
  "docs_url": "/docs",
  "health_url": "/health",
  "environment": "production"
}
```

---

## API Versioning

All endpoints are available both at the root path (for compatibility) and with the `/api/v1` prefix for proper versioning:

Example:
- `/registerTourist` (legacy)
- `/api/v1/registerTourist` (versioned)

## OpenAPI Documentation

Interactive API documentation is available at:
```
http://165.232.188.221:8000/docs
```

ReDoc alternative documentation:
```
http://165.232.188.221:8000/redoc
```